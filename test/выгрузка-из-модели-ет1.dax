EVALUATE
	VAR _et =
		SELECTCOLUMNS(
			'ет1',
			"индекс", 'ет1'[индекс],
			"индекс иерархия", 'ет1'[индекс иерархия],
			
			"дата", 'ет1'[дата] + 0,
			"проект_key", 'ет1'[проект_key] & "",
			"проект", 'ет1'[проект],
			"подпроект", 'ет1'[подпроект],
			"организация", 'ет1'[организация] & "",
			
			"зимний коэф", 'ет1'[зимний коэф],
			"зимний коэф условие", 'ет1'[зимний коэф условие],
			
			"корректировка дата", 'ет1'[корректировка дата],
			"корректировка маркер", 'ет1'[корректировка маркер],
			"корректировка норма исключить", 'ет1'[корректировка норма исключить],
			
			"ркц_key",'ет1'[ркц_key] & "",
			"ркц вед поз", 'ет1'[ркц вед поз],
			"ркц поз суб_ет1", 'ет1'[ркц поз суб],
			"ркц поз ген_ет1",'ет1'[ркц поз ген],
			"ркц ур1_ет1", 'ет1'[ркц ур1],
			"ркц ур2_ет1", 'ет1'[ркц ур2],
			"ркц ур3_ет1", 'ет1'[ркц ур3],
			"ркц ур4_ет1", 'ет1'[ркц ур4],
			"ркц ур5_ет1", 'ет1'[ркц ур5],
			"ркц описание_ет1", 'ет1'[ркц описание],
			"работа описание_ет1", 'ет1'[работа описание],
			"ед изм_ет1", 'ет1'[ед изм],
			"опимс", 'ет1'[опимс] & "",
			"опимс вед поз", 'ет1'[опимс вед поз],
			
			"норма контракт", 'ет1'[норма контракт],
			"объем факт", 'ет1'[объем факт],
			
			"часы контракт", 'ет1'[часы контракт],
			"часы контракт зимний", 'ет1'[часы контракт зимний],
			"часы факт", 'ет1'[часы факт],
			"часы факт техника", 'ет1'[часы факт техника],

			"трудозатраты категория", 'ет1'[трудозатраты категория] & "",
			"классификатор", 'ет1'[классификатор] & "",
			"цех монтаж", 'ет1'[цех монтаж],
			"di сварено", 'ет1'[di сварено],
			"di типоразмер", 'ет1'[di типоразмер],
			"материал", 'ет1'[материал],

			"имя файла", 'ет1'[имя файла]
		)
				
	VAR _calendar = 
		SELECTCOLUMNS(
			'календарь',
			"дата", 'календарь'[дата] + 0,
			"месяц", 'календарь'[месяц],
			"месяц год", 'календарь'[месяц год],
			"год", 'календарь'[год],
			"декада месяц год", 'календарь'[декада месяц год]
		)
		
	VAR _project = 
		SELECTCOLUMNS(
			'проект',
			"проект_key", 'проект'[проект_key] & "",
			"проект отчет", 'проект'[проект отчет],
			"подпроект отчет", 'проект'[подпроект отчет]
		)
		
	VAR _subsontractor =
		SELECTCOLUMNS(
			'организация',
			"организация", 'организация'[организация] & "",
			"организация отчет", 'организация'[организация отчет]
		)
		
	VAR _opims = 
		SELECTCOLUMNS(
			'опимс',
			"опимс", 'опимс'[опимс] & "",
			"опимс описание", 'опимс'[опимс описание],
			"опимс описание с ед изм и кодом", 'опимс'[опимс описание с ед изм и кодом],
			"ед изм", 'опимс'[ед изм],
			"опимс укр", 'опимс'[опимс укр],
			"опимс ур1 с ед изм", 'опимс'[опимс ур1 с ед изм],
			"опимс ур1 вед поз", 'опимс'[опимс ур1 вед поз],
			"опимс ур2 с ед изм", 'опимс'[опимс ур2 с ед изм],
			"опимс ур2 вед поз", 'опимс'[опимс ур2 вед поз],
			"опимс ур3 с ед изм", 'опимс'[опимс ур3 с ед изм],
			"опимс ур3 вед поз", 'опимс'[опимс ур3 вед поз]
		)
	VAR _rkc = 
		SELECTCOLUMNS(
			'ркц',
			"ркц_key", 'ркц'[ркц_key] & "",
			"договор номер", 'ркц'[договор номер],
			"договор дата", 'ркц'[договор дата],
			"договор дс", 'ркц'[договор дс],
			"ркц поз суб_ркц", 'ркц'[ркц поз суб],
			"ркц поз ген_ркц", 'ркц'[ркц поз ген],
			"ркц поз ген вед_ркц", 'ркц'[ркц поз ген вед],
			"ркц описание_ркц", 'ркц'[ркц описание],
			"ркц поз и описание суб_ркц", 'ркц'[ркц поз и описание суб],
			"ркц поз и описание суб с ед изм_ркц", 'ркц'[ркц поз и описание суб с ед изм],
			"ркц поз и описание ген_ркц", 'ркц'[ркц поз и описание ген],
			"ркц поз и описание ген с ед изм_ркц", 'ркц'[ркц поз и описание ген с ед изм],
			"ркц ур1_ркц", 'ркц'[ркц ур1],
			"ркц ур2_ркц", 'ркц'[ркц ур2],
			"ркц ур3_ркц", 'ркц'[ркц ур3],
			"ркц ур4_ркц", 'ркц'[ркц ур4],
			"ед изм_ркц", 'ркц'[ед изм]
		)
	VAR _rkc_amt = 
		SELECTCOLUMNS(
			'ркц объемы',
			"ркц_key", 'ркц объемы'[ркц_key] & "",
			"цена руб_ркц", 'ркц объемы'[цена руб],
			"цена доллар_ркц", 'ркц объемы'[цена доллар],
			"цена евро_ркц", 'ркц объемы'[цена евро],
			"стоимость руб_ркц", 'ркц объемы'[стоимость руб],
			"стоимость доллар_ркц", 'ркц объемы'[стоимость доллар],
			"стоимость евро_ркц", 'ркц объемы'[стоимость евро]
		)
	VAR _classificator = 
		SELECTCOLUMNS(
			'классификатор',
			"классификатор", 'классификатор'[классификатор] & "",
			"классификатор описание", 'классификатор'[классификатор описание],
			"классификатор с описанием", 'классификатор'[классификатор с описанием]
		)


//	VAR _key_positions = 
//		ALLEXCEPT(
//			'ключевые',
//			'ключевые'[ключевые_key],
//			'ключевые'[ключевые_parrent_key],
//			'ключевые'[ед изм],
//			'ключевые'[ключевые ур1 с ед изм срез],
//			'ключевые'[ключевые ур1 с ед изм_sort],
//			'ключевые'[ключевые ур2 с ед изм срез]
//		)
	
	var _rkc_with_amt = NATURALINNERJOIN(_rkc, _rkc_amt)
	VAR _join = 
		NATURALLEFTOUTERJOIN(
			NATURALLEFTOUTERJOIN(
				NATURALLEFTOUTERJOIN(
					NATURALLEFTOUTERJOIN(
						NATURALLEFTOUTERJOIN(
							NATURALLEFTOUTERJOIN(
								_et, 
								_calendar
							),
							_project
						),
						_subsontractor
					),
					_opims
				),
				_rkc_with_amt
			),
		_classificator
		)
	VAR _order_cols = 
		SELECTCOLUMNS(
			_join,
			"индекс", [индекс],
			"индекс иерархия", [индекс иерархия],
			"дата", [дата],
			"месяц", [месяц],
			"месяц год", [месяц год],
			"год", [год],
			"декада месяц год", [декада месяц год],
			"проект_key", [проект_key],
			"проект", [проект],
			"проект отчет", [проект отчет],
			"подпроект", [подпроект],
			"подпроект отчет", [подпроект отчет],
			"организация", [организация],
			"организация отчет", [организация отчет],
			"зимний коэф", [зимний коэф],
			"зимний коэф условие", [зимний коэф условие],
			"корректировка дата", [корректировка дата],
			"корректировка маркер", [корректировка маркер],
			"корректировка норма исключить", [корректировка норма исключить],
			"ркц_key", [ркц_key],
			"ркц вед поз", [ркц вед поз],
			"договор номер", [договор номер],
			"договор дата", [договор дата],
			"договор дс", [договор дс],
			"ркц поз суб_ркц", [ркц поз суб_ркц],
			"ркц поз ген_ркц", [ркц поз ген_ркц],
			"ркц поз ген вед_ркц", [ркц поз ген вед_ркц],
			"ркц описание_ркц", [ркц описание_ркц],
			"ркц поз и описание суб_ркц", [ркц поз и описание суб_ркц],
			"ркц поз и описание суб с ед изм_ркц", [ркц поз и описание суб с ед изм_ркц],
			"ркц поз и описание ген_ркц", [ркц поз и описание ген_ркц],
			"ркц поз и описание ген с ед изм_ркц", [ркц поз и описание ген с ед изм_ркц],
			"ркц ур1_ркц", [ркц ур1_ркц],
			"ркц ур2_ркц", [ркц ур2_ркц],
			"ркц ур3_ркц", [ркц ур3_ркц],
			"ркц ур4_ркц", [ркц ур4_ркц],
			"ед изм_ркц", [ед изм_ркц],
			"цена руб_ркц", [цена руб_ркц],
			"цена доллар_ркц", [цена доллар_ркц],
			"цена евро_ркц", [цена евро_ркц],
			"стоимость руб_ркц", [стоимость руб_ркц],
			"стоимость доллар_ркц", [стоимость доллар_ркц],
			"стоимость евро_ркц", [стоимость евро_ркц],
			"ркц поз суб_ет1", [ркц поз суб_ет1],
			"ркц поз ген_ет1", [ркц поз ген_ет1],
			"ркц ур1_ет1", [ркц ур1_ет1],
			"ркц ур2_ет1", [ркц ур2_ет1],
			"ркц ур3_ет1", [ркц ур3_ет1],
			"ркц ур4_ет1", [ркц ур4_ет1],
			"ркц ур5_ет1", [ркц ур5_ет1],
			"ркц описание_ет1", [ркц описание_ет1],
			"работа описание_ет1", [работа описание_ет1],
			"ед изм_ет1", [ед изм_ет1],
			"опимс", [опимс],
			"опимс вед поз", [опимс вед поз],
			"опимс описание", [опимс описание],
			"опимс описание с ед изм и кодом", [опимс описание с ед изм и кодом],
			"ед изм", [ед изм],
			"опимс укр", [опимс укр],
			"опимс ур1 с ед изм", [опимс ур1 с ед изм],
			"опимс ур1 вед поз", [опимс ур1 вед поз],
			"опимс ур2 с ед изм", [опимс ур2 с ед изм],
			"опимс ур2 вед поз", [опимс ур2 вед поз],
			"опимс ур3 с ед изм", [опимс ур3 с ед изм],
			"опимс ур3 вед поз", [опимс ур3 вед поз],
			"норма контракт", [норма контракт],
			"объем факт", [объем факт],
			"часы контракт", [часы контракт],
			"часы контракт зимний", [часы контракт зимний],
			"часы факт", [часы факт],
			"часы факт техника", [часы факт техника],
			"трудозатраты категория", [трудозатраты категория],
			"классификатор", [классификатор],
			"классификатор описание", [классификатор описание],
			"классификатор с описанием", [классификатор с описанием],
			"цех монтаж", [цех монтаж],
			"di сварено", [di сварено],
			"di типоразмер", [di типоразмер],
			"материал", [материал],
			"имя файла", [имя файла]
		)

	RETURN _order_cols