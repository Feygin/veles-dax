EVALUATE
	VAR _extra_hours =
		SELECTCOLUMNS(
			'доп часы',
			"дата", 'доп часы'[дата] + 0,
			"проект_key", 'доп часы'[проект_key] & "",
			"проект", 'доп часы'[проект],
			"подпроект", 'доп часы'[подпроект],
			"организация", 'доп часы'[организация] & "",
			"классификатор", 'доп часы'[классификатор] & "",
			"опимс укр", 'доп часы'[опимс укр] & "",
			"часы факт", 'доп часы'[часы факт]
		)
				
	VAR _calendar = 
		SELECTCOLUMNS(
			'календарь',
			"дата", 'календарь'[дата] + 0,
			"месяц", 'календарь'[месяц],
			"месяц год", 'календарь'[месяц год],
			"год", 'календарь'[год]
		)
		
	VAR _project = 
		SELECTCOLUMNS(
			'проект',
			"проект_key", 'проект'[проект_key] & "",
			"проект отчет", 'проект'[проект отчет],
			"подпроект отчет", 'проект'[подпроект отчет]
		)
		
	VAR _subsontractor =
		SELECTCOLUMNS(
			'организация',
			"организация", 'организация'[организация] & "",
			"организация отчет", 'организация'[организация отчет]
		)
		
	VAR _opims = 
		SELECTCOLUMNS(
			'опимс',
			"опимс укр", 'опимс'[опимс укр] & "",
			"опимс ур1 с ед изм", 'опимс'[опимс ур1 с ед изм],
			"опимс ур1 вед поз", 'опимс'[опимс ур1 вед поз],
			"опимс ур2 с ед изм", 'опимс'[опимс ур2 с ед изм],
			"опимс ур2 вед поз", 'опимс'[опимс ур2 вед поз]
		)

	VAR _classificator = 
		SELECTCOLUMNS(
			'классификатор',
			"классификатор", 'классификатор'[классификатор] & "",
			"классификатор описание", 'классификатор'[классификатор описание],
			"классификатор с описанием", 'классификатор'[классификатор с описанием]
		)
	

	VAR _join = 
		NATURALLEFTOUTERJOIN(
			NATURALLEFTOUTERJOIN(
				NATURALLEFTOUTERJOIN(
					NATURALLEFTOUTERJOIN(
						NATURALLEFTOUTERJOIN(
							_extra_hours, 
							_calendar
						),
						_project
					),
					_subsontractor
				),
				_opims
			),
			_classificator
		)
	VAR _order_cols = 
		SELECTCOLUMNS(
			_join,
			"дата", [дата],
			"месяц", [месяц],
			"месяц год", [месяц год],
			"год", [год],
			"проект_key", [проект_key],
			"проект", [проект],
			"проект отчет", [проект отчет],
			"подпроект", [подпроект],
			"подпроект отчет", [подпроект отчет],
			"организация", [организация],
			"организация отчет", [организация отчет],
			"опимс укр", [опимс укр],
			"опимс ур1 с ед изм", [опимс ур1 с ед изм],
			"опимс ур1 вед поз", [опимс ур1 вед поз],
			"опимс ур2 с ед изм", [опимс ур2 с ед изм],
			"опимс ур2 вед поз", [опимс ур2 вед поз],
			"часы факт", [часы факт]
		)

	RETURN _order_cols